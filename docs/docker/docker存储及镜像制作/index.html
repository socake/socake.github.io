<!doctype html><html lang=zh-CN dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="zh-CN"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Docker存储及镜像制作 &#183; Startlight</title><meta name=title content="Docker存储及镜像制作 &#183; Startlight"><meta name=description content="docker存储测试"><meta name=keywords content="Docker,"><link rel=canonical href=https://your_domain.com/docs/docker/docker%E5%AD%98%E5%82%A8%E5%8F%8A%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/><meta name=author content="Wenzhuo Huang"><link href=17691281867@163.com rel=me><meta property="og:url" content="https://your_domain.com/docs/docker/docker%E5%AD%98%E5%82%A8%E5%8F%8A%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/"><meta property="og:site_name" content="Startlight"><meta property="og:title" content="Docker存储及镜像制作"><meta property="og:description" content="docker存储测试"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-12-03T22:26:23+08:00"><meta property="article:modified_time" content="2025-12-03T22:26:23+08:00"><meta property="article:tag" content="Docker"><meta property="og:image" content="https://your_domain.com/docs/docker/docker%E5%AD%98%E5%82%A8%E5%8F%8A%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/featured.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://your_domain.com/docs/docker/docker%E5%AD%98%E5%82%A8%E5%8F%8A%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/featured.jpg"><meta name=twitter:title content="Docker存储及镜像制作"><meta name=twitter:description content="docker存储测试"><link type=text/css rel=stylesheet href=/css/main.bundle.min.0975a8c7c266a0697f94839b45e1574c449de253527d44ed516d5c5c3c820c9389d7d86576faae12267b129f8749ecbf7581cddb636aba7690aa633b95aaa87d.css integrity="sha512-CXWox8JmoGl/lIObReFXTESd4lNSfUTtUW1cXDyCDJOJ19hldvquEiZ7Ep+HSey/dYHN22NqunaQqmM7laqofQ=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.9df4fc14d50efcc9aa4cfc2b6f348e365f421f5ad491278f8f48c0360cf2f93f08882fda6da162d7ace8e5add57c2df4ac46bd3861306b1d4c452cd31f448d64.js integrity="sha512-nfT8FNUO/MmqTPwrbzSONl9CH1rUkSePj0jANgzy+T8IiC/abaFi16zo5a3VfC30rEa9OGEwax1MRSzTH0SNZA==" data-copy=复制 data-copied=已复制></script><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Docs","name":"Docker存储及镜像制作","headline":"Docker存储及镜像制作","description":"docker存储测试","inLanguage":"zh-CN","url":"https://your_domain.com/docs/docker/docker%E5%AD%98%E5%82%A8%E5%8F%8A%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/","author":{"@type":"Person","name":"Wenzhuo Huang"},"copyrightYear":"2025","dateCreated":"2025-12-03T22:26:23\u002b08:00","datePublished":"2025-12-03T22:26:23\u002b08:00","dateModified":"2025-12-03T22:26:23\u002b08:00","keywords":["Docker"],"mainEntityOfPage":"true","wordCount":"1286"}]</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
跳过正文</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32"><div class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium">Startlight</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/posts/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=博客 title=Posts><p class="text-base font-medium">博客</p></a><a href=/books/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=书籍 title=我的数字书架><p class="text-base font-medium">书籍</p></a><a href class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=编程 title><p class="text-base font-medium">编程</p></a><a href=https://github.com/socake target=_blank class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=GitHub title><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><p class="text-base font-medium">GitHub</p></a><div><div class="cursor-pointer flex items-center nested-menu"><a aria-label=文档 class="text-base font-medium hover:text-primary-600 dark:hover:text-primary-400" title><p>文档</p></a><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/categories/docker/ aria-label=docker class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title=Docker>docker</p></a></div></div></div></div><div><div class="cursor-pointer flex items-center nested-menu"><a aria-label=资源 class="text-base font-medium hover:text-primary-600 dark:hover:text-primary-400" title><p>资源</p></a><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/tags/%E6%A8%A1%E6%9D%BF/ aria-label=模板 class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title=模板>模板</p></a><a href aria-label=网站 class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title>网站</p></a></div></div></div></div><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="搜索 (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="搜索 (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/posts/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=博客 title=Posts><p class="text-bg font-bg">博客</p></a></li><li class=mt-1><a href=/books/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=书籍 title=我的数字书架><p class="text-bg font-bg">书籍</p></a></li><li class=mt-1><a href class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=编程 title><p class="text-bg font-bg">编程</p></a></li><li class=mt-1><a href=https://github.com/socake target=_blank class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=GitHub title><div class=mr-2><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></div><p class="text-bg font-bg">GitHub</p></a></li><li class=mt-1><a href aria-label=文档 class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>文档</p><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></a></li><li class=mt-1><a href=/categories/docker/ aria-label=docker class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title=Docker>docker</p></a></li><li class=mb-2></li><li class=mt-1><a href aria-label=资源 class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>资源</p><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></a></li><li class=mt-1><a href=/tags/%E6%A8%A1%E6%9D%BF/ aria-label=模板 class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title=模板>模板</p></a></li><li class=mt-1><a href aria-label=网站 class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title>网站</p></a></li><li class=mb-2></li></ul></div></div></div></div></div></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"><img id=background-image src=/docs/docker/docker%E5%AD%98%E5%82%A8%E5%8F%8A%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/featured_hu_cdfb79a85bda34be.jpg alt=Docker存储及镜像制作 loading=eager decoding=async fetchpriority=high class="absolute inset-0 w-full h-full object-cover"><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=background-blur data-image-id=background-image data-image-url=/docs/docker/docker%E5%AD%98%E5%82%A8%E5%8F%8A%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/featured_hu_cdfb79a85bda34be.jpg></script><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Docker存储及镜像制作</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-12-03T22:26:23+08:00>2025-12-03 22:26</time><span class="px-2 text-primary-500">&#183;</span><span>1286 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>7 分钟</span></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">目录</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><ul><li><a href=#1-bind-mounts-绑定挂载>1. <strong>Bind Mounts (绑定挂载)</strong></a></li><li><a href=#2-volumes-数据卷>2. <strong>Volumes (数据卷)</strong></a></li><li><a href=#3-tmpfs-mounts-临时文件系统挂载>3. <strong>tmpfs Mounts (临时文件系统挂载)</strong></a></li><li><a href=#总结对比><strong>总结对比：</strong></a></li></ul></li></ul><ul><li><ul><li><a href=#1-私有register>1. 私有register</a></li><li><a href=#2-harbor仓库>2. harbor仓库</a></li></ul></li></ul><ul><li><a href=#1-dockerfile的指令>1. Dockerfile的指令</a></li><li><a href=#2-常用命令详解>2. 常用命令详解</a><ul><li><a href=#21-from>2.1 FROM</a></li><li><a href=#22-arg>2.2 ARG</a></li><li><a href=#23-run>2.3 RUN</a><ul><li><a href=#减少层数>减少层数</a></li><li><a href=#使用--和--控制流程>使用 <code>&&</code> 和 <code>||</code> 控制流程</a></li><li><a href=#使用--和-set--ex>使用 <code>&&</code> 和 <code>set -ex</code></a></li><li><a href=#exec与cmd格式的区别>exec与cmd格式的区别</a></li></ul></li><li><a href=#24-cmdentryporint>2.4 CMD&amp;ENTRYPORINT</a><ul><li><a href=#cmd>CMD</a></li><li><a href=#entrypoint>ENTRYPOINT</a></li><li><a href=#cmd和enyporint的联合使用>CMD和ENYPORINT的联合使用</a></li></ul></li><li><a href=#25-label>2.5 LABEL</a></li><li><a href=#26-env>2.6 ENV</a></li><li><a href=#27-expose>2.7 EXPOSE</a></li><li><a href=#28-onbuild>2.8 ONBUILD</a></li><li><a href=#29-user>2.9 USER</a></li></ul></li></ul><ul><li><a href=#1-docker-日志驱动logging-drivers>1. <strong>Docker 日志驱动（Logging Drivers）</strong></a><ul><li><ul><li><a href=#设置日志驱动>设置日志驱动</a></li></ul></li></ul></li><li><a href=#2-查看-docker-容器日志>2. <strong>查看 Docker 容器日志</strong></a></li><li><a href=#3-docker-日志的存储与管理>3. <strong>Docker 日志的存储与管理</strong></a><ul><li><ul><li><a href=#json-file-驱动日志格式>json-file 驱动日志格式：</a></li></ul></li><li><a href=#日志轮转和日志大小限制>日志轮转和日志大小限制</a></li></ul></li><li><a href=#4-集中式日志收集与分析>4. <strong>集中式日志收集与分析</strong></a></li><li><a href=#5-日志分析和监控>5. <strong>日志分析和监控</strong></a><ul><li><ul><li><a href=#使用-prometheus--grafana-监控-docker-日志>使用 Prometheus + Grafana 监控 Docker 日志：</a></li></ul></li><li><a href=#总结>总结</a></li></ul></li></ul><ul><li><a href=#1docker-compose的使用>1.docker-compose的使用</a></li><li><a href=#2-docker-compose的yaml>2. docker-compose的yaml</a><ul><li><ul><li><a href=#检测docker-compose配置>检测docker-compose配置</a></li></ul></li></ul></li><li><a href=#3-docker-compose的相关命令>3. docker-compose的相关命令</a><ul><li><a href=#docker-compose-常用命令>Docker Compose 常用命令</a></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">目录</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><ul><li><a href=#1-bind-mounts-绑定挂载>1. <strong>Bind Mounts (绑定挂载)</strong></a></li><li><a href=#2-volumes-数据卷>2. <strong>Volumes (数据卷)</strong></a></li><li><a href=#3-tmpfs-mounts-临时文件系统挂载>3. <strong>tmpfs Mounts (临时文件系统挂载)</strong></a></li><li><a href=#总结对比><strong>总结对比：</strong></a></li></ul></li></ul><ul><li><ul><li><a href=#1-私有register>1. 私有register</a></li><li><a href=#2-harbor仓库>2. harbor仓库</a></li></ul></li></ul><ul><li><a href=#1-dockerfile的指令>1. Dockerfile的指令</a></li><li><a href=#2-常用命令详解>2. 常用命令详解</a><ul><li><a href=#21-from>2.1 FROM</a></li><li><a href=#22-arg>2.2 ARG</a></li><li><a href=#23-run>2.3 RUN</a><ul><li><a href=#减少层数>减少层数</a></li><li><a href=#使用--和--控制流程>使用 <code>&&</code> 和 <code>||</code> 控制流程</a></li><li><a href=#使用--和-set--ex>使用 <code>&&</code> 和 <code>set -ex</code></a></li><li><a href=#exec与cmd格式的区别>exec与cmd格式的区别</a></li></ul></li><li><a href=#24-cmdentryporint>2.4 CMD&amp;ENTRYPORINT</a><ul><li><a href=#cmd>CMD</a></li><li><a href=#entrypoint>ENTRYPOINT</a></li><li><a href=#cmd和enyporint的联合使用>CMD和ENYPORINT的联合使用</a></li></ul></li><li><a href=#25-label>2.5 LABEL</a></li><li><a href=#26-env>2.6 ENV</a></li><li><a href=#27-expose>2.7 EXPOSE</a></li><li><a href=#28-onbuild>2.8 ONBUILD</a></li><li><a href=#29-user>2.9 USER</a></li></ul></li></ul><ul><li><a href=#1-docker-日志驱动logging-drivers>1. <strong>Docker 日志驱动（Logging Drivers）</strong></a><ul><li><ul><li><a href=#设置日志驱动>设置日志驱动</a></li></ul></li></ul></li><li><a href=#2-查看-docker-容器日志>2. <strong>查看 Docker 容器日志</strong></a></li><li><a href=#3-docker-日志的存储与管理>3. <strong>Docker 日志的存储与管理</strong></a><ul><li><ul><li><a href=#json-file-驱动日志格式>json-file 驱动日志格式：</a></li></ul></li><li><a href=#日志轮转和日志大小限制>日志轮转和日志大小限制</a></li></ul></li><li><a href=#4-集中式日志收集与分析>4. <strong>集中式日志收集与分析</strong></a></li><li><a href=#5-日志分析和监控>5. <strong>日志分析和监控</strong></a><ul><li><ul><li><a href=#使用-prometheus--grafana-监控-docker-日志>使用 Prometheus + Grafana 监控 Docker 日志：</a></li></ul></li><li><a href=#总结>总结</a></li></ul></li></ul><ul><li><a href=#1docker-compose的使用>1.docker-compose的使用</a></li><li><a href=#2-docker-compose的yaml>2. docker-compose的yaml</a><ul><li><ul><li><a href=#检测docker-compose配置>检测docker-compose配置</a></li></ul></li></ul></li><li><a href=#3-docker-compose的相关命令>3. docker-compose的相关命令</a><ul><li><a href=#docker-compose-常用命令>Docker Compose 常用命令</a></li></ul></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><h1 class="relative group">五、Docker存储管理<div id=五docker存储管理 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e4%ba%94docker%e5%ad%98%e5%82%a8%e7%ae%a1%e7%90%86 aria-label=锚点>#</a></span></h1><h3 class="relative group">1. <strong>Bind Mounts (绑定挂载)</strong><div id=1-bind-mounts-绑定挂载 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#1-bind-mounts-%e7%bb%91%e5%ae%9a%e6%8c%82%e8%bd%bd aria-label=锚点>#</a></span></h3><ul><li><p><strong>描述</strong>：绑定挂载将宿主机的文件或目录映射到容器内的某个路径。当你使用绑定挂载时，容器的数据将直接存储在宿主机的文件系统中，因此容器和宿主机之间共享文件系统。如果宿主机路径不存在，Docker 会自动创建它。</p></li><li><p><strong>特点</strong>：</p><ul><li><strong>直接依赖宿主机的文件系统</strong>：容器访问和修改的数据直接存储在宿主机上。</li><li><strong>与宿主机紧密耦合</strong>：宿主机的文件或目录位置固定，因此，如果宿主机上的文件丢失，容器的数据也会丢失。。</li></ul></li><li><p><strong>创建命令</strong>：</p><pre tabindex=0><code>docker run -v /host/path:/container/path mycontainer
</code></pre><p>其中 <code>/host/path</code> 是宿主机上的文件或目录路径，<code>/container/path</code> 是容器内的路径。</p><p>这将宿主机上的 <code>/home/user/data</code> 目录挂载到容器内的 <code>/data</code> 目录。</p></li></ul><h3 class="relative group">2. <strong>Volumes (数据卷)</strong><div id=2-volumes-数据卷 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#2-volumes-%e6%95%b0%e6%8d%ae%e5%8d%b7 aria-label=锚点>#</a></span></h3><ul><li><strong>描述</strong>：数据卷是 Docker 提供的一种更为抽象的持久化存储方式。Docker 会将数据存储在宿主机的特定目录中，但用户无需直接管理这个目录。Docker 会自动处理数据存储的位置、生命周期等。</li><li><strong>特点</strong>：<ul><li><strong>抽象化管理</strong>：数据卷由 Docker 管理，宿主机的位置和细节对用户透明。</li><li><strong>持久性</strong>：即使容器被删除，数据卷中的数据仍然存在，可以随时重新挂载到其他容器中。</li><li><strong>便于共享</strong>：多个容器可以挂载同一个数据卷，方便容器之间共享数据。</li><li><strong>自动化管理</strong>：Docker 可以自动清理不再使用的数据卷。</li><li><strong>优化性能</strong>：数据卷是为持久化数据优化的，性能通常较好。</li></ul></li></ul><img src=https://imagebed99.oss-cn-beijing.aliyuncs.com/typora_image/Image00085.jpg alt=Image00085 style=zoom:50%><ul><li><p><strong>创建命令</strong>：</p><pre tabindex=0><code>docker volume create myvolume
docker run -v myvolume:/container/path mycontainer
</code></pre><p>其中 <code>myvolume</code> 是创建的数据卷的名称，<code>/container/path</code> 是容器内的挂载路径。</p></li><li><p><strong>查看和管理数据卷</strong>：</p><ul><li><p>查看所有数据卷：</p><pre tabindex=0><code>docker volume ls
</code></pre></li><li><p>查看某个数据卷的详细信息：</p><pre tabindex=0><code>docker volume inspect mydbdata
</code></pre></li><li><p>删除数据卷：</p><pre tabindex=0><code>docker volume rm mydbdata
</code></pre></li></ul></li><li><p><strong>注意事项</strong>：</p><ul><li>Docker 会将数据卷存储在宿主机的默认位置（通常是 <code>/var/lib/docker/volumes/</code>）中，但用户不需要关心该位置。</li><li>数据卷支持容器间的共享，如果多个容器挂载同一个数据卷，容器间的数据修改会实时同步。</li></ul></li></ul><h3 class="relative group">3. <strong>tmpfs Mounts (临时文件系统挂载)</strong><div id=3-tmpfs-mounts-临时文件系统挂载 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#3-tmpfs-mounts-%e4%b8%b4%e6%97%b6%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f%e6%8c%82%e8%bd%bd aria-label=锚点>#</a></span></h3><ul><li><p><strong>描述</strong>：<code>tmpfs</code> 是将容器的文件系统挂载到宿主机的内存中，通常用于存储临时数据。<code>tmpfs</code> 挂载提供的是一个<strong>临时的内存存储</strong>，数据不会写入到磁盘，在容器停止或重启时会丢失。</p></li><li><p><strong>适用场景</strong>：</p><ul><li>存储需要高性能、临时且不持久化的数据，例如缓存文件、会话信息等。</li><li>不希望数据保留在宿主机上，也不希望数据在容器重启后丢失的场景。</li></ul></li><li><p><strong>特点</strong>：</p><ul><li><strong>内存存储</strong>：所有数据都存储在内存中，速度较快。</li><li><strong>非持久化</strong>：容器停止或重启时，数据会丢失。</li><li><strong>有限容量</strong>：<code>tmpfs</code> 占用宿主机的内存，因此需要适当配置内存限制。</li><li><strong>临时文件存储</strong>：适用于需要临时存储的数据，避免占用磁盘空间。</li></ul></li><li><p><strong>创建命令</strong>：</p><pre tabindex=0><code>docker run --mount type=tmpfs,target=/container/path mycontainer
</code></pre><p>这将为容器 <code>/container/path</code> 创建一个 <code>tmpfs</code> 挂载。</p></li><li><p><strong>示例</strong>：</p><pre tabindex=0><code>docker run --mount type=tmpfs,target=/tmp mycontainer
</code></pre><p>这将把容器的 <code>/tmp</code> 目录挂载为一个临时的内存文件系统。</p></li><li><p><strong>注意事项</strong>：</p><ul><li>内存挂载不会持久化数据，容器停止后数据会丢失。</li><li><code>tmpfs</code> 挂载通常用于高性能要求的临时存储（如缓存或日志数据）。</li></ul></li></ul><hr><h3 class="relative group"><strong>总结对比：</strong><div id=总结对比 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e6%80%bb%e7%bb%93%e5%af%b9%e6%af%94 aria-label=锚点>#</a></span></h3><table><thead><tr><th>特性</th><th><strong>Bind Mounts</strong></th><th><strong>Volumes</strong></th><th><strong>tmpfs Mounts</strong></th></tr></thead><tbody><tr><td><strong>存储位置</strong></td><td>宿主机文件系统的指定路径</td><td>Docker 管理的宿主机目录</td><td>容器的内存</td></tr><tr><td><strong>数据持久化</strong></td><td>容器停止后数据不会丢失（依赖宿主机路径）</td><td>容器删除后数据不会丢失</td><td>容器停止后数据丢失</td></tr><tr><td><strong>使用场景</strong></td><td>容器与宿主机共享文件（开发环境）</td><td>持久化数据存储和容器间共享数据</td><td>临时数据存储（缓存、日志等）</td></tr><tr><td><strong>性能</strong></td><td>较慢（文件系统挂载）</td><td>较快，专为持久化数据优化</td><td>非常快（内存存储）</td></tr><tr><td><strong>共享数据</strong></td><td>容器和宿主机间共享，容器间不共享</td><td>容器间可以共享</td><td>不适用于容器间共享</td></tr><tr><td><strong>管理难易</strong></td><td>用户手动管理宿主机路径</td><td>Docker 自动管理</td><td>需要内存资源限制</td></tr></tbody></table><h1 class="relative group">六、Docker仓库管理<div id=六docker仓库管理 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e5%85%addocker%e4%bb%93%e5%ba%93%e7%ae%a1%e7%90%86 aria-label=锚点>#</a></span></h1><h3 class="relative group">1. 私有register<div id=1-私有register class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#1-%e7%a7%81%e6%9c%89register aria-label=锚点>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker pull registry
</span></span><span class=line><span class=cl>docker run -idt --name registry -v  /opt/registry:/var/lib/registry -p 5000:5000
</span></span></code></pre></div><h3 class="relative group">2. harbor仓库<div id=2-harbor仓库 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#2-harbor%e4%bb%93%e5%ba%93 aria-label=锚点>#</a></span></h3><p>Harbor 是由 VMWare 公司开源的容器镜像仓库。事实上， Harbor 是在 Docker Registry 上进行了相应的企业级扩展，从而获得了更加广泛的应用，这些新的企业级特性包括：管理用户界面，基于角色的访问控制 ，AD/LDAP 集成以及审计日志等，足以满足基本企业需求。</p><p>官方 : <a href=https://goharbor.io/ target=_blank>https://goharbor.io/</a></p><p>Github: <a href=https://github.com/goharbor/harbor target=_blank>https://github.com/goharbor/harbor</a></p><p>服务器硬件配置：</p><p>最低要求： CPU2 核 / 内存 4G/ 硬盘 40GB</p><p>推荐： CPU4 核 / 内存 8G/ 硬盘 160GB</p><h1 class="relative group">七、DockerFile<div id=七dockerfile class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e4%b8%83dockerfile aria-label=锚点>#</a></span></h1><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=Image00035 src=https://imagebed99.oss-cn-beijing.aliyuncs.com/typora_image/Image00035.jpg></figure><h2 class="relative group">1. Dockerfile的指令<div id=1-dockerfile的指令 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#1-dockerfile%e7%9a%84%e6%8c%87%e4%bb%a4 aria-label=锚点>#</a></span></h2><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=在这里插入图片描述 src=https://imagebed99.oss-cn-beijing.aliyuncs.com/typora_image/202412072342206.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=在这里插入图片描述 src=https://imagebed99.oss-cn-beijing.aliyuncs.com/typora_image/202412072342947.png></figure><table><thead><tr><th><strong>指令</strong></th><th><strong>描述</strong></th><th><strong>示例</strong></th></tr></thead><tbody><tr><td><strong>FROM</strong></td><td>指定基础镜像，Dockerfile 的第一行通常是 <code>FROM</code>，它指定了构建镜像所依赖的基础镜像。</td><td><code>FROM ubuntu:20.04</code></td></tr><tr><td><strong>RUN</strong></td><td>执行命令并创建一个新的镜像层，常用于安装软件包或执行一些配置任务。</td><td><code>RUN apt-get update && apt-get install -y python3</code></td></tr><tr><td><strong>CMD</strong></td><td>容器启动时默认执行的命令，如果 <code>docker run</code> 中没有指定命令，<code>CMD</code> 指令指定的命令会被执行。</td><td><code>CMD ["python", "app.py"]</code></td></tr><tr><td><strong>ENTRYPOINT</strong></td><td>设置容器启动时执行的主命令，<code>ENTRYPOINT</code> 和 <code>CMD</code> 配合使用，指定容器启动的命令和参数。</td><td><code>ENTRYPOINT ["python", "app.py"]</code></td></tr><tr><td><strong>COPY</strong></td><td>将本地文件或目录复制到镜像中的指定路径。</td><td><code>COPY ./localfile.txt /app/</code></td></tr><tr><td><strong>ADD</strong></td><td>类似 <code>COPY</code>，但支持更多功能，比如自动解压 tar 文件，下载 URL 中的文件并添加到镜像中。</td><td><code>ADD ./archive.tar.gz /app/</code></td></tr><tr><td><strong>EXPOSE</strong></td><td>声明容器在运行时监听的端口，帮助文档和 Docker 网络相关功能使用。</td><td><code>EXPOSE 80</code></td></tr><tr><td><strong>ENV</strong></td><td>设置环境变量，可以在容器内的运行时被引用。</td><td><code>ENV APP_ENV=production</code></td></tr><tr><td><strong>WORKDIR</strong></td><td>设置工作目录，所有后续的指令都会在该目录下执行。</td><td><code>WORKDIR /app</code></td></tr><tr><td><strong>VOLUME</strong></td><td>创建一个挂载点，挂载到容器内的指定目录。</td><td><code>VOLUME ["/data"]</code></td></tr><tr><td><strong>USER</strong></td><td>指定容器内执行命令时使用的用户。</td><td><code>USER myuser</code></td></tr><tr><td><strong>ARG</strong></td><td>定义构建时使用的参数，构建时通过 <code>--build-arg</code> 设置。</td><td><code>ARG VERSION=1.0</code></td></tr><tr><td><strong>LABEL</strong></td><td>为镜像添加元数据，常用于描述镜像的作者、版本等信息。</td><td><code>LABEL version="1.0" maintainer="yourname@example.com"</code></td></tr><tr><td><strong>SHELL</strong></td><td>设置默认的 shell 类型和选项。默认是 <code>/bin/sh -c</code>，可以使用其他 shell，如 <code>/bin/bash -c</code>。</td><td><code>SHELL ["/bin/bash", "-c"]</code></td></tr><tr><td><strong>HEALTHCHECK</strong></td><td>定义容器的健康检查机制，用于确保容器在运行时的状态是否正常。</td><td>`HEALTHCHECK CMD curl &ndash;fail http://localhost:8080/</td></tr><tr><td><strong>STOPSIGNAL</strong></td><td>设置容器停止时使用的信号。默认是 SIGTERM，用户可以修改为其他信号。</td><td><code>STOPSIGNAL SIGINT</code></td></tr></tbody></table><h2 class="relative group">2. 常用命令详解<div id=2-常用命令详解 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#2-%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4%e8%af%a6%e8%a7%a3 aria-label=锚点>#</a></span></h2><h3 class="relative group">2.1 FROM<div id=21-from class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#21-from aria-label=锚点>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># 格式：
</span></span></span><span class=line><span class=cl><span class=gh></span>　　FROM &lt;image&gt;
</span></span><span class=line><span class=cl>　　FROM &lt;image&gt;:&lt;tag&gt;
</span></span><span class=line><span class=cl>　　FROM &lt;image&gt;@&lt;digest&gt;
</span></span><span class=line><span class=cl>　　FROM [ --platform=xxx] &lt;image:tag&gt; [AS &lt;name&gt;]     <span class=ni>#指定基础镜像平台及二次构建的基础名称</span>
</span></span><span class=line><span class=cl>　　
</span></span><span class=line><span class=cl><span class=gh># 参数解释：
</span></span></span><span class=line><span class=cl><span class=gh></span>    --platfrom 用于指定平台镜像，参数有：linux/amd64 , linux/arm64 ,windows/amd64
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gh># 示例：　　
</span></span></span><span class=line><span class=cl><span class=gh></span>	FROM mysql:5.6
</span></span><span class=line><span class=cl><span class=gh># 注：
</span></span></span><span class=line><span class=cl><span class=gh></span>   tag或digest是可选的，如果不使用这两个值时，会使用latest版本的基础镜像
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=line><span class=cl><span class=c>### 多阶段构建</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 第一阶段</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=w> </span><span class=s>node:14</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=s>builder</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=w> </span><span class=s>/app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> package.json ./<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> npm install<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> npm run build<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># 第二阶段</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=w> </span><span class=s>nginx:alpine</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --from<span class=o>=</span>builder /app/build /usr/share/nginx/html<span class=err>
</span></span></span></code></pre></div><h3 class="relative group">2.2 ARG<div id=22-arg class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#22-arg aria-label=锚点>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh>#指令语法
</span></span></span><span class=line><span class=cl><span class=gh></span>ARG &lt;name&gt;[=&lt;dafault value] 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gh># 示例
</span></span></span><span class=line><span class=cl><span class=gh></span>ARG CODE=latets
</span></span><span class=line><span class=cl>FROM base:$CODE
</span></span></code></pre></div><p>说明：ARG仅在编译时生效，且可以出现在FROM之前。ENV指定的变量保存于镜像之中</p><h3 class="relative group">2.3 RUN<div id=23-run class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#23-run aria-label=锚点>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># RUN用于在构建镜像时执行命令，其有以下两种命令执行方式：
</span></span></span><span class=line><span class=cl><span class=gh># shell执行
</span></span></span><span class=line><span class=cl><span class=gh></span>格式：
</span></span><span class=line><span class=cl>    RUN &lt;command&gt;
</span></span><span class=line><span class=cl>    RUN echo &#34;Hello, World!&#34;
</span></span><span class=line><span class=cl><span class=gh># exec执行
</span></span></span><span class=line><span class=cl><span class=gh></span>格式：
</span></span><span class=line><span class=cl>    RUN [&#34;executable&#34;, &#34;param1&#34;, &#34;param2&#34;]
</span></span><span class=line><span class=cl>示例：
</span></span><span class=line><span class=cl>    RUN [ &#34;/bin/bash&#34;,&#34;-c&#34;,&#34;echo&#34;, &#34;Hello, World!&#34;]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>注：RUN指令创建的中间镜像会被缓存，并会在下次构建中使用。如果不想使用这些缓存镜像，
</span></span><span class=line><span class=cl>可以在构建时指定--no-cache参数，如：docker build --no-cache
</span></span></code></pre></div><h4 class="relative group">减少层数<div id=减少层数 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e5%87%8f%e5%b0%91%e5%b1%82%e6%95%b0 aria-label=锚点>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>RUN</span> apt-get update <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    apt-get install -y curl <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    apt-get clean <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    rm -rf /var/lib/apt/lists/*<span class=err>
</span></span></span></code></pre></div><h4 class="relative group">使用 <code>&&</code> 和 <code>||</code> 控制流程<div id=使用--和--控制流程 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e4%bd%bf%e7%94%a8--%e5%92%8c--%e6%8e%a7%e5%88%b6%e6%b5%81%e7%a8%8b aria-label=锚点>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>RUN make install &amp;&amp; echo &#34;Install succeeded&#34; || echo &#34;Install failed&#34;
</span></span></code></pre></div><h4 class="relative group">使用 <code>&&</code> 和 <code>set -ex</code><div id=使用--和-set--ex class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e4%bd%bf%e7%94%a8--%e5%92%8c-set--ex aria-label=锚点>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>RUN set -ex &amp;&amp; \
</span></span><span class=line><span class=cl>    apt-get update &amp;&amp; \
</span></span><span class=line><span class=cl>    apt-get install -y curl
</span></span><span class=line><span class=cl>构建过程中可以跟踪每个命令的执行情况，可以使用 set -ex。这将在命令执行失败时导致构建停止，并显示所有执行的命令
</span></span></code></pre></div><h4 class="relative group">exec与cmd格式的区别<div id=exec与cmd格式的区别 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#exec%e4%b8%8ecmd%e6%a0%bc%e5%bc%8f%e7%9a%84%e5%8c%ba%e5%88%ab aria-label=锚点>#</a></span></h4><p><strong>Exec 格式</strong>的语法如下：</p><pre tabindex=0><code>dockerfile复制代码RUN [&#34;executable&#34;, &#34;param1&#34;, &#34;param2&#34;, ...]
</code></pre><ul><li><p><strong>直接执行</strong>：在 Exec 格式中，Docker 直接执行指定的可执行文件（如 <code>echo</code>）。它不会经过 shell 进程。这意味着任何通常在 shell 中处理的特性（如命令替换、变量扩展、管道、重定向等）将不会被执行。</p></li><li><p>缺少 shell 功能</p><p>：由于没有使用 shell，Exec 格式不会处理如下情况：</p><ul><li>环境变量扩展：在 Exec 格式中，您不能像在 shell 中那样使用 <code>$VAR</code> 来引用环境变量。</li><li>命令连接：不能使用 <code>&&</code>、<code>||</code> 等逻辑操作符来连接命令。</li><li>输入输出重定向：像 <code>></code> 或 <code>&lt;</code> 的重定向操作将不适用</li></ul></li></ul><h3 class="relative group">2.4 CMD&amp;ENTRYPORINT<div id=24-cmdentryporint class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#24-cmdentryporint aria-label=锚点>#</a></span></h3><h4 class="relative group">CMD<div id=cmd class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#cmd aria-label=锚点>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># 格式：
</span></span></span><span class=line><span class=cl><span class=gh></span>    CMD [&#34;executable&#34;,&#34;param1&#34;,&#34;param2&#34;] (执行可执行文件，优先)
</span></span><span class=line><span class=cl>    CMD [&#34;param1&#34;,&#34;param2&#34;] (设置了ENTRYPOINT，则直接调用ENTRYPOINT添加参数)
</span></span><span class=line><span class=cl>    CMD command param1 param2 (执行shell内部命令)
</span></span><span class=line><span class=cl><span class=gh># 示例：
</span></span></span><span class=line><span class=cl><span class=gh></span>    CMD echo &#34;This is a test.&#34; | wc -l
</span></span><span class=line><span class=cl>    CMD [&#34;/usr/bin/wc&#34;,&#34;--help&#34;]
</span></span></code></pre></div><p>注：CMD不同于RUN，CMD用于指定在容器启动时所要执行的命令，而RUN用于指定镜像构建时所要执行的命令。</p><h4 class="relative group">ENTRYPOINT<div id=entrypoint class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#entrypoint aria-label=锚点>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># 格式：
</span></span></span><span class=line><span class=cl><span class=gh></span>    ENTRYPOINT [&#34;executable&#34;, &#34;param1&#34;, &#34;param2&#34;] (可执行文件, 优先)
</span></span><span class=line><span class=cl>    ENTRYPOINT [&#34;executable&#34;, &#34;param1&#34;] （后续可接收CMD的传参，或run命令的传参）
</span></span><span class=line><span class=cl>    ENTRYPOINT command param1 param2 (shell内部命令)
</span></span><span class=line><span class=cl><span class=gh># 示例：
</span></span></span><span class=line><span class=cl><span class=gh></span>    FROM ubuntu
</span></span><span class=line><span class=cl>    ENTRYPOINT [&#34;ls&#34;, &#34;/usr/local&#34;]
</span></span><span class=line><span class=cl>    CMD [&#34;/usr/local/tomcat&#34;]
</span></span><span class=line><span class=cl>  之后，docker run 传递的参数，都会先覆盖cmd,然后由cmd 传递给entrypoint ,做到灵活应用
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=gh># shell和exec的区别
</span></span></span><span class=line><span class=cl><span class=gh></span>shell 格式会阻止CMD的参数及run命令行参数被使用，但执行的命令会变成shell子命令，无法正常接收single
</span></span></code></pre></div><p>注：ENTRYPOINT与CMD非常类似，不同的是通过docker run执行的命令不会覆盖ENTRYPOINT，
而docker run命令中指定的任何参数，都会被当做参数再次传递给CMD。
Dockerfile中只允许有一个ENTRYPOINT命令，多指定时会覆盖前面的设置，
而只执行最后的ENTRYPOINT指令。
通常情况下，ENTRYPOINT 与CMD一起使用，ENTRYPOINT 写默认命令，当需要参数时候 使用CMD传参</p><h4 class="relative group">CMD和ENYPORINT的联合使用<div id=cmd和enyporint的联合使用 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#cmd%e5%92%8cenyporint%e7%9a%84%e8%81%94%e5%90%88%e4%bd%bf%e7%94%a8 aria-label=锚点>#</a></span></h4><table><thead><tr><th><strong>ENTRYPOINT</strong></th><th><strong>CMD</strong></th><th><strong>执行结果</strong></th></tr></thead><tbody><tr><td>无入口 (无 ENTRYPOINT)</td><td>无命令 (无 CMD)</td><td>容器会退出，无任何动作</td></tr><tr><td>无入口 (无 ENTRYPOINT)</td><td>exec 格式 CMD</td><td>执行 CMD 指定的命令</td></tr><tr><td>无入口 (无 ENTRYPOINT)</td><td>shell 格式 CMD</td><td>执行 CMD 指定的命令</td></tr><tr><td>exec 格式 ENTRYPOINT</td><td>无命令 (无 CMD)</td><td>执行 ENTRYPOINT 指定的命令</td></tr><tr><td>exec 格式 ENTRYPOINT</td><td>exec 格式 CMD</td><td>以 CMD 的内容作为参数传递给 ENTRYPOINT 执行</td></tr><tr><td>exec 格式 ENTRYPOINT</td><td>shell 格式 CMD</td><td>CMD 会被作为参数传递给 ENTRYPOINT 执行（shell 命令）</td></tr><tr><td>shell 格式 ENTRYPOINT</td><td>无命令 (无 CMD)</td><td>执行 ENTRYPOINT 指定的 shell 命令</td></tr><tr><td>shell 格式 ENTRYPOINT</td><td>exec 格式 CMD</td><td>CMD 会作为参数传递给 ENTRYPOINT 执行，执行 shell 命令</td></tr><tr><td>shell 格式 ENTRYPOINT</td><td>shell 格式 CMD</td><td>CMD 会作为参数传递给 ENTRYPOINT 执行，执行 shell 命令</td></tr></tbody></table><h3 class="relative group">2.5 LABEL<div id=25-label class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#25-label aria-label=锚点>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># 格式：
</span></span></span><span class=line><span class=cl><span class=gh></span>    LABEL &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...
</span></span><span class=line><span class=cl><span class=gh># 示例：
</span></span></span><span class=line><span class=cl><span class=gh></span>　　LABEL version=&#34;1.0&#34; description=&#34;这是一个Web服务器&#34; by=&#34;IT笔录&#34;
</span></span><span class=line><span class=cl>注：
</span></span><span class=line><span class=cl>　　使用LABEL指定元数据时，一条LABEL指定可以指定一或多条元数据，指定多条元数据时不同元数据
</span></span><span class=line><span class=cl>　　之间通过空格分隔。推荐将所有的元数据通过一条LABEL指令指定，以免生成过多的中间镜像。
</span></span></code></pre></div><h3 class="relative group">2.6 ENV<div id=26-env class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#26-env aria-label=锚点>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># 格式：
</span></span></span><span class=line><span class=cl><span class=gh></span>    ENV &lt;key&gt; &lt;value&gt;  #&lt;key&gt;之后的所有内容均会被视为其&lt;value&gt;的组成部分，因此，一次只能设置一个变量
</span></span><span class=line><span class=cl>    ENV &lt;key&gt;=&lt;value&gt; ...  <span class=ni>#可以设置多个变量</span>，每个变量为一个&#34;&lt;key&gt;=&lt;value&gt;&#34;的键值对，如果&lt;key&gt;中包含空格，可以使用\来进行转义，也可以通过&#34;&#34;来进行标示；另外，反斜线也可以用于续行
</span></span><span class=line><span class=cl><span class=gh># 示例：
</span></span></span><span class=line><span class=cl><span class=gh></span>    ENV myName=&#34;John Doe&#34;
</span></span><span class=line><span class=cl>    ENV myDog=Rex\ The\ Dog	
</span></span><span class=line><span class=cl>    ENV myCat=fluffy
</span></span></code></pre></div><h3 class="relative group">2.7 EXPOSE<div id=27-expose class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#27-expose aria-label=锚点>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># 格式：
</span></span></span><span class=line><span class=cl><span class=gh></span>    EXPOSE &lt;port&gt; [&lt;port&gt;...]
</span></span><span class=line><span class=cl><span class=gh># 示例：
</span></span></span><span class=line><span class=cl><span class=gh></span>    EXPOSE 80 443
</span></span><span class=line><span class=cl>    EXPOSE 8080    
</span></span><span class=line><span class=cl>    EXPOSE 11211/tcp 11211/udp
</span></span><span class=line><span class=cl>注：EXPOSE并不会让容器的端口访问到主机。要使其可访问，需要在docker run运行容器时通过-p来发布这些端口，或通过-P参数来发布EXPOSE导出的所有端口。只是增加dockerfile的可读性
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>如果没有暴露端口，后期也可以通过-p 8080:80方式映射端口，但是不能通过-P形式映射
</span></span></code></pre></div><h3 class="relative group">2.8 ONBUILD<div id=28-onbuild class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#28-onbuild aria-label=锚点>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># 格式：　
</span></span></span><span class=line><span class=cl><span class=gh></span>	ONBUILD [INSTRUCTION]
</span></span><span class=line><span class=cl><span class=gh># 示例：
</span></span></span><span class=line><span class=cl><span class=gh></span>　　ONBUILD ADD . /app/src
</span></span><span class=line><span class=cl>　　ONBUILD RUN /usr/local/bin/python-build --dir /app/src
</span></span><span class=line><span class=cl>注：
</span></span><span class=line><span class=cl>　　NNBUID后面跟指令，当当前的镜像被用做其它镜像的基础镜像，该镜像中的触发器将会被钥触发
</span></span></code></pre></div><h3 class="relative group">2.9 USER<div id=29-user class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#29-user aria-label=锚点>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># 格式:　　
</span></span></span><span class=line><span class=cl><span class=gh></span>USER user　　
</span></span><span class=line><span class=cl>USER user:group　　
</span></span><span class=line><span class=cl>USER uid　　
</span></span><span class=line><span class=cl>USER uid:gid　　
</span></span><span class=line><span class=cl>USER user:gid　　
</span></span><span class=line><span class=cl>USER uid:group
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=gh># 示例：    　　
</span></span></span><span class=line><span class=cl><span class=gh></span>     USER www
</span></span><span class=line><span class=cl> 注：
</span></span><span class=line><span class=cl>　　使用USER指定用户后，Dockerfile中其后的命令RUN、CMD、ENTRYPOINT都将使用该用户。
</span></span><span class=line><span class=cl>　　镜像构建完成后，通过docker run运行容器时，可以通过-u参数来覆盖所指定的用户。
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># 格式
</span></span></span><span class=line><span class=cl><span class=gh></span> SHELL [&#34;executable&#34;, &#34;parameters&#34;]
</span></span><span class=line><span class=cl><span class=k>-</span> executable：要使用的 shell 可执行文件（如 /bin/bash 或 /bin/sh 等）。
</span></span><span class=line><span class=cl><span class=k>-</span> parameters：传递给 shell 的参数，通常是一个字符串数组
</span></span><span class=line><span class=cl><span class=gh># 示例（默认情况下，Docker 使用 /bin/sh -c 来执行命令）
</span></span></span><span class=line><span class=cl><span class=gh></span>SHELL [&#34;/bin/bash&#34;, &#34;-c&#34;]   <span class=ni>#使用</span> bash 替代默认的 sh
</span></span><span class=line><span class=cl>RUN echo &#34;Hello from Bash!&#34;  # 后续命令将使用 bash 执行
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gh># 注意
</span></span></span><span class=line><span class=cl><span class=gh></span>SHELL 指令在 Dockerfile 中是全局生效的，这意味着它会影响 Dockerfile 中后续的所有命令（如 RUN, CMD, ENTRYPOINT 等）。
</span></span><span class=line><span class=cl>SHELL 只影响容器内执行命令时使用的 shell 类型，不会影响容器启动时的 shell 类型
</span></span></code></pre></div><h1 class="relative group">八、Docker日志管理<div id=八docker日志管理 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e5%85%abdocker%e6%97%a5%e5%bf%97%e7%ae%a1%e7%90%86 aria-label=锚点>#</a></span></h1><h2 class="relative group">1. <strong>Docker 日志驱动（Logging Drivers）</strong><div id=1-docker-日志驱动logging-drivers class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#1-docker-%e6%97%a5%e5%bf%97%e9%a9%b1%e5%8a%a8logging-drivers aria-label=锚点>#</a></span></h2><p>Docker 提供了多种日志驱动，可以选择适合自己需求的方式来记录和管理容器日志。每个容器可以配置不同的日志驱动，Docker 默认使用的日志驱动是 <code>json-file</code>。在启动容器时，可以通过 <code>--log-driver</code> 参数指定日志驱动。</p><p>常见的日志驱动有：</p><table><thead><tr><th><strong>日志驱动</strong></th><th><strong>描述</strong></th><th><strong>示例</strong></th></tr></thead><tbody><tr><td><strong>json-file</strong></td><td>默认的日志驱动，日志以 JSON 格式存储在宿主机上的文件中。每个日志条目包含了时间戳、日志级别、消息等信息。</td><td><code>docker run --log-driver=json-file ...</code></td></tr><tr><td><strong>syslog</strong></td><td>将日志发送到宿主机的 syslog 服务。适用于需要集成系统日志收集的场景。</td><td><code>docker run --log-driver=syslog ...</code></td></tr><tr><td><strong>journald</strong></td><td>将日志发送到 <code>systemd</code> 的 journal 服务。适用于基于 <code>systemd</code> 的 Linux 系统。</td><td><code>docker run --log-driver=journald ...</code></td></tr><tr><td><strong>fluentd</strong></td><td>将日志发送到 Fluentd，用于集成日志收集和分析系统。</td><td><code>docker run --log-driver=fluentd ...</code></td></tr><tr><td><strong>gelf</strong></td><td>使用 Graylog Extended Log Format (GELF)，通常与 Graylog 配合使用。适用于大规模日志聚合和分析。</td><td><code>docker run --log-driver=gelf ...</code></td></tr><tr><td><strong>awslogs</strong></td><td>将日志发送到 AWS CloudWatch Logs，适用于在 AWS 环境中管理日志。</td><td><code>docker run --log-driver=awslogs ...</code></td></tr><tr><td><strong>splunk</strong></td><td>将日志发送到 Splunk 日志管理系统。</td><td><code>docker run --log-driver=splunk ...</code></td></tr><tr><td><strong>none</strong></td><td>禁用容器日志，不收集任何日志。</td><td><code>docker run --log-driver=none ...</code></td></tr></tbody></table><h4 class="relative group">设置日志驱动<div id=设置日志驱动 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e8%ae%be%e7%bd%ae%e6%97%a5%e5%bf%97%e9%a9%b1%e5%8a%a8 aria-label=锚点>#</a></span></h4><p>可以在容器启动时通过 <code>--log-driver</code> 参数指定日志驱动。例如：</p><pre tabindex=0><code>bashCopy Codedocker run --log-driver=syslog my-container
</code></pre><p>也可以在 Docker 守护进程配置文件中设置默认的日志驱动，这样所有容器都会使用该日志驱动。例如，在 <code>/etc/docker/daemon.json</code> 文件中添加：</p><pre tabindex=0><code>jsonCopy Code{
  &#34;log-driver&#34;: &#34;fluentd&#34;
}
</code></pre><h2 class="relative group">2. <strong>查看 Docker 容器日志</strong><div id=2-查看-docker-容器日志 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#2-%e6%9f%a5%e7%9c%8b-docker-%e5%ae%b9%e5%99%a8%e6%97%a5%e5%bf%97 aria-label=锚点>#</a></span></h2><p>不同的日志驱动存储日志的方式不同，但无论使用哪种驱动，Docker 都提供了基本的命令来查看容器的日志。</p><ul><li><strong>查看容器日志</strong>：使用 <code>docker logs</code> 命令来查看某个容器的日志。该命令支持实时查看、过滤、分页等操作。</li></ul><pre tabindex=0><code>bashCopy Codedocker logs &lt;container_id or container_name&gt;
</code></pre><ul><li><p>常用选项</p><ul><li><code>-f</code> 或 <code>--follow</code>：实时跟踪日志输出，类似于 <code>tail -f</code>。</li><li><code>--since</code>：查看指定时间之后的日志。</li><li><code>--tail</code>：显示最后 N 行日志。</li><li><code>-t</code>：显示日志的时间戳。</li></ul></li></ul><p>例如，查看容器 <code>my-container</code> 的日志并实时跟踪输出：</p><pre tabindex=0><code>bashCopy Codedocker logs -f --since=&#34;2024-12-05T10:00:00&#34; my-container
</code></pre><h2 class="relative group">3. <strong>Docker 日志的存储与管理</strong><div id=3-docker-日志的存储与管理 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#3-docker-%e6%97%a5%e5%bf%97%e7%9a%84%e5%ad%98%e5%82%a8%e4%b8%8e%e7%ae%a1%e7%90%86 aria-label=锚点>#</a></span></h2><p>Docker 默认将容器日志存储在宿主机的 <code>/var/lib/docker/containers/&lt;container-id>/</code> 目录中，日志文件名为 <code>container-id-json.log</code>。这对于 <code>json-file</code> 日志驱动有效，其他日志驱动可能将日志输出到不同的地方。</p><h4 class="relative group">json-file 驱动日志格式：<div id=json-file-驱动日志格式 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#json-file-%e9%a9%b1%e5%8a%a8%e6%97%a5%e5%bf%97%e6%a0%bc%e5%bc%8f aria-label=锚点>#</a></span></h4><ul><li>时间戳</li><li>日志级别</li><li>日志消息</li></ul><p>例如，默认的日志文件 <code>/var/lib/docker/containers/&lt;container-id>/&lt;container-id>-json.log</code> 可能包含以下内容：</p><pre tabindex=0><code>jsonCopy Code{&#34;log&#34;:&#34;Hello, World!\n&#34;,&#34;stream&#34;:&#34;stdout&#34;,&#34;time&#34;:&#34;2024-12-05T10:00:00.000000000Z&#34;}
{&#34;log&#34;:&#34;Error: Something went wrong!\n&#34;,&#34;stream&#34;:&#34;stderr&#34;,&#34;time&#34;:&#34;2024-12-05T10:01:00.000000000Z&#34;}
</code></pre><h3 class="relative group">日志轮转和日志大小限制<div id=日志轮转和日志大小限制 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e6%97%a5%e5%bf%97%e8%bd%ae%e8%bd%ac%e5%92%8c%e6%97%a5%e5%bf%97%e5%a4%a7%e5%b0%8f%e9%99%90%e5%88%b6 aria-label=锚点>#</a></span></h3><p>对于 <code>json-file</code> 驱动，Docker 提供了日志轮转功能，通过配置 <code>max-size</code> 和 <code>max-file</code> 来限制日志文件的大小和数量。</p><ul><li><code>max-size</code>：每个日志文件的最大大小。</li><li><code>max-file</code>：最多保留多少个日志文件。</li></ul><p>例如，在启动容器时设置日志轮转：</p><pre tabindex=0><code>bashCopy Codedocker run --log-driver=json-file --log-opt max-size=10m --log-opt max-file=3 my-container
</code></pre><p>这表示每个日志文件的最大大小为 10MB，最多保留 3 个文件，达到限制时会进行轮转。</p><h2 class="relative group">4. <strong>集中式日志收集与分析</strong><div id=4-集中式日志收集与分析 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#4-%e9%9b%86%e4%b8%ad%e5%bc%8f%e6%97%a5%e5%bf%97%e6%94%b6%e9%9b%86%e4%b8%8e%e5%88%86%e6%9e%90 aria-label=锚点>#</a></span></h2><p>对于生产环境中的容器，通常会使用集中式日志收集和分析工具来管理日志。常见的工具和方案包括：</p><ul><li><strong>ELK Stack</strong>：Elasticsearch, Logstash, Kibana。Logstash 作为日志收集工具将日志发送到 Elasticsearch，Kibana 用于分析和可视化日志数据。</li><li><strong>Fluentd</strong>：作为日志收集和转发工具，将日志发送到其他日志管理系统（如 Elasticsearch、Kafka 等）。</li><li><strong>Graylog</strong>：一个开源的日志管理平台，支持集成多种日志来源。</li><li><strong>Splunk</strong>：一个商业化的日志分析平台，广泛用于企业级日志管理和监控。</li></ul><h2 class="relative group">5. <strong>日志分析和监控</strong><div id=5-日志分析和监控 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#5-%e6%97%a5%e5%bf%97%e5%88%86%e6%9e%90%e5%92%8c%e7%9b%91%e6%8e%a7 aria-label=锚点>#</a></span></h2><p>除了查看容器日志外，日志分析和监控工具能够帮助自动化地识别和报警，尤其是在大规模容器化环境中。结合 Prometheus、Grafana 等工具，可以对日志进行集中的监控和可视化。</p><h4 class="relative group">使用 Prometheus + Grafana 监控 Docker 日志：<div id=使用-prometheus--grafana-监控-docker-日志 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e4%bd%bf%e7%94%a8-prometheus--grafana-%e7%9b%91%e6%8e%a7-docker-%e6%97%a5%e5%bf%97 aria-label=锚点>#</a></span></h4><ul><li><strong>Prometheus</strong>：收集和存储来自 Docker 容器的度量数据。</li><li><strong>Grafana</strong>：用来显示和分析这些度量数据。</li></ul><p>通过安装 Docker 的 <code>cAdvisor</code> 或 <code>Prometheus</code> 采集器，可以定期抓取 Docker 容器的日志数据，进一步做健康检查、性能分析等。</p><h3 class="relative group">总结<div id=总结 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e6%80%bb%e7%bb%93 aria-label=锚点>#</a></span></h3><p>Docker 提供了多种日志管理机制，可以通过不同的日志驱动、配置选项和集中式日志系统来满足不同的需求。根据实际的生产环境需求，可以选择合适的日志驱动（如 <code>json-file</code>、<code>syslog</code>、<code>fluentd</code> 等），并配置日志的轮转、存储和分析机制，以实现高效的日志管理和问题排查。</p><h1 class="relative group">九、Docker Compose<div id=九docker-compose class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e4%b9%9ddocker-compose aria-label=锚点>#</a></span></h1><p>Docker Compose要解决的问题是部署和管理繁多的服务，Docker Compose并不是通过脚本和各种冗长的<code>docker</code> 命令来将应用组件组织起来，而是通过一个声明式的配置文件描述整个应用，从而使用一条命令完成部署。</p><p>下载<a href=https://github.com/docker/compose/releases/download target=_blank>地址</a></p><h2 class="relative group">1.docker-compose的使用<div id=1docker-compose的使用 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#1docker-compose%e7%9a%84%e4%bd%bf%e7%94%a8 aria-label=锚点>#</a></span></h2><ol><li><strong>多容器应用管理</strong>
Docker Compose 可以定义多个服务（服务是指 Docker 容器中的应用），这些服务可以在一个 YAML 文件中配置，Compose 会在启动时自动创建并启动这些服务。常见的场景如：Web 应用（前端）、数据库、缓存服务等多个容器的组合。</li><li><strong>开发与测试环境的自动化部署</strong>
在开发和测试阶段，开发人员往往需要启动多个依赖服务（例如数据库、缓存、消息队列等），<code>docker-compose</code> 可以一次性启动这些服务，确保开发和测试环境一致性。</li><li><strong>简化配置与扩展</strong>
使用 <code>docker-compose.yml</code> 配置文件，可以将服务的配置集中管理，通过声明式的方式方便修改和更新配置。对于不同的环境（如开发、测试、生产），可以使用不同的 Compose 配置文件，轻松切换。</li><li><strong>版本控制与共享</strong>
由于 <code>docker-compose.yml</code> 是文本文件，开发者可以将其添加到版本控制系统中（如 Git），并与团队成员共享，从而确保每个人在相同的环境下工作。</li></ol><h2 class="relative group">2. docker-compose的yaml<div id=2-docker-compose的yaml class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#2-docker-compose%e7%9a%84yaml aria-label=锚点>#</a></span></h2><p><code>docker-compose.yml</code> 文件是 Docker Compose 的核心配置文件，使用 YAML 格式定义，主要包括以下几个部分。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>version: <span class=s2>&#34;3.8&#34;</span>  <span class=c1># 指定 Compose 文件的版本</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>services:  <span class=c1># 服务部分，定义各个容器</span>
</span></span><span class=line><span class=cl>  web:  <span class=c1># 服务名称</span>
</span></span><span class=line><span class=cl>    image: nginx:latest  <span class=c1># 使用的镜像</span>
</span></span><span class=line><span class=cl>    ports:
</span></span><span class=line><span class=cl>      - <span class=s2>&#34;8080:80&#34;</span>  <span class=c1># 映射端口</span>
</span></span><span class=line><span class=cl>    volumes:
</span></span><span class=line><span class=cl>      - ./html:/usr/share/nginx/html  <span class=c1># 映射本地文件夹到容器</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  db:
</span></span><span class=line><span class=cl>    image: mysql:5.7
</span></span><span class=line><span class=cl>    environment:
</span></span><span class=line><span class=cl>      MYSQL_ROOT_PASSWORD: example
</span></span><span class=line><span class=cl>    volumes:
</span></span><span class=line><span class=cl>      - db-data:/var/lib/mysql  <span class=c1># 使用命名卷</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  redis:
</span></span><span class=line><span class=cl>    image: redis:alpine
</span></span><span class=line><span class=cl>    ports:
</span></span><span class=line><span class=cl>      - <span class=s2>&#34;6379:6379&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>volumes:  <span class=c1># 定义数据卷</span>
</span></span><span class=line><span class=cl>  db-data:
</span></span></code></pre></div><h4 class="relative group">检测docker-compose配置<div id=检测docker-compose配置 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e6%a3%80%e6%b5%8bdocker-compose%e9%85%8d%e7%bd%ae aria-label=锚点>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker-compose config     <span class=c1># 检查配置</span>
</span></span><span class=line><span class=cl>docker-compose config -q  <span class=c1># 检查配置，有问题才有输出</span>
</span></span></code></pre></div><h2 class="relative group">3. docker-compose的相关命令<div id=3-docker-compose的相关命令 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#3-docker-compose%e7%9a%84%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4 aria-label=锚点>#</a></span></h2><h3 class="relative group">Docker Compose 常用命令<div id=docker-compose-常用命令 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#docker-compose-%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4 aria-label=锚点>#</a></span></h3><table><thead><tr><th>命令</th><th>功能</th><th>示例</th></tr></thead><tbody><tr><td><code>docker-compose up</code></td><td>启动所有定义的服务容器，并在后台运行。如果服务未构建，会自动构建。</td><td><code>docker-compose up</code> 或 <code>docker-compose up -d</code>（后台运行）</td></tr><tr><td><code>docker-compose down</code></td><td>停止并删除所有容器、网络、卷等资源。</td><td><code>docker-compose down</code></td></tr><tr><td><code>docker-compose build</code></td><td>构建或重新构建服务的镜像（如果配置了 <code>build</code>）。</td><td><code>docker-compose build</code></td></tr><tr><td><code>docker-compose logs</code></td><td>查看服务的日志输出。</td><td><code>docker-compose logs</code> 或 <code>docker-compose logs &lt;服务名></code></td></tr><tr><td><code>docker-compose ps</code></td><td>查看运行中的容器及其状态。</td><td><code>docker-compose ps</code></td></tr><tr><td><code>docker-compose exec</code></td><td>在运行中的容器内执行命令（例如进入容器的 bash）。</td><td><code>docker-compose exec web bash</code></td></tr><tr><td><code>docker-compose stop</code></td><td>停止运行中的容器，但不删除。</td><td><code>docker-compose stop</code></td></tr><tr><td><code>docker-compose restart</code></td><td>重启服务容器。</td><td><code>docker-compose restart</code></td></tr></tbody></table></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full me-4" width=96 height=96 alt="Wenzhuo Huang" src=/img/111_hu_94a5aa86fe6456a0.png data-zoom-src=/img/111_hu_b80d70f6efb86b15.png><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">作者</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Wenzhuo Huang</div><div class="text-sm text-neutral-700 dark:text-neutral-400">幽默模块加载中&mldr;加载失败，请重新启动</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=17691281867@163.com target=_blank aria-label=Email title=Email rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></span></a></div></div></div></div><div class=mb-10></div><h2 class="mt-8 text-2xl font-extrabold mb-10">相关文章</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><article class="relative min-h-full min-w-full overflow-hidden rounded border border-2 border-neutral-200 shadow-2xl dark:border-neutral-700"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/docs/docker/docker%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/featured_hu_61788c7df39d13c3.jpg alt=Docker基本使用 loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class="px-6 py-4"><header><a href=/docs/docker/docker%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Docker基本使用</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-12-03T22:26:23+08:00>2025-12-03 22:26</time><span class="px-2 text-primary-500">&#183;</span><span>1775 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>9 分钟</span></div></div><div class="prose dark:prose-invert py-1"></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="relative min-h-full min-w-full overflow-hidden rounded border border-2 border-neutral-200 shadow-2xl dark:border-neutral-700"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/docs/docker/docker%E7%AE%80%E4%BB%8B/featured_hu_61788c7df39d13c3.jpg alt=Docker简介 loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class="px-6 py-4"><header><a href=/docs/docker/docker%E7%AE%80%E4%BB%8B/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Docker简介</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-12-03T22:26:23+08:00>2025-12-03 22:26</time><span class="px-2 text-primary-500">&#183;</span><span>376 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>2 分钟</span></div></div><div class="prose dark:prose-invert py-1"></div></div><div class="px-6 pt-4 pb-2"></div></article></section></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_docs/docker/docker存储及镜像制作/index.md data-oid-likes=likes_docs/docker/docker存储及镜像制作/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/docs/docker/docker%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Docker基本使用
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-12-03T22:26:23+08:00>2025-12-03 22:26</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/docs/linux/linux%E5%91%BD%E4%BB%A4/%E5%AE%8C%E6%95%B4%E5%AE%89%E8%A3%85%E5%8C%85%E4%B8%8B%E8%BD%BD/><span class=leading-6>完整安装包下载&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-12-03T22:53:28+08:00>2025-12-03 22:53</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label=返回顶部 title=返回顶部>&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/posts/authors/ title=Authors>作者</a></li><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/tags/ title=Tags>标签</a></li><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/categories/ title=Categories>分类</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
Wenzhuo Huang</p><p class="text-xs text-neutral-500 dark:text-neutral-400">由 <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a> 强力驱动</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://your_domain.com/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=搜索 tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="关闭 (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>